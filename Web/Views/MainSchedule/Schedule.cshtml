@model MainScheduleViewModel
@{
	ViewData["Title"] = "Schedule";
}

<div class="modal fade" id="modDialog">
		<div class="modal-dialog" id="dialogContent">
		</div>
</div>

<div>
		<div class="row flex-nowrap">
			<div class="col-1"></div>
			@foreach(Group group in Model.Groups)
			{
			<div class="col-2">
				<h6 class="text-center">@group.Speciality.Shortname-@group.Name</h6>
			</div>
			}
		</div>
		
	@for (int weekdayId = 1; weekdayId < 7; weekdayId++)
	{
		<div class="row flex-nowrap" style="height:600px; margin-bottom:100px">
			<div class="col-1" style="display:flex; align-items:center; justify-content:center;">
				<h6 class="m-0" style="width:1px; word-wrap:break-word; vertical-align:middle;">@Model.Weekdays[weekdayId-1]</h6>
			</div>
			@foreach (Group group in Model.Groups)
			{
				<div class="col-2 p-0">
					@for (int i = 1; i < 7; i++)
					{
						<div class="row border m-1" style="height:17%">
							@if (Model.Lessons.Any(x=>x.Group.Id == group.Id && x.LessonNumber == i && x.Weekday == weekdayId))
							{
								LessonPlan firstLesson = Model
								.Lessons
								.Where(x => x.Group.Id == group.Id && x.LessonNumber == i 
								&& x.Weekday == weekdayId && x.WeekNumber == 0)
								.FirstOrDefault();
								LessonPlan secondLesson = Model
								.Lessons
								.Where(x => x.Group.Id == group.Id && x.LessonNumber == i 
								&& x.Weekday == weekdayId && x.WeekNumber == 1)
								.FirstOrDefault();

								if (secondLesson == null)
								{
									<a class="selectedLesson" href="/MainSchedule/Lesson?groupId=@group.Id&lessonNumber=@i&weekday=@weekdayId">
										<h6>@firstLesson.Subject.Name</h6>
									</a>
								}
								else if (firstLesson == null && secondLesson != null)
								{
									<div class="border" style="height:50%; "></div>
									<a class="selectedLesson border" style="height: 50%" href="/MainSchedule/Lesson?groupId=@group.Id&lessonNumber=@i&weekday=@weekdayId">
										<h6>@secondLesson.Subject.Name</h6>
									</a>
								}
								else
								{
									<a class="selectedLesson border" href="/MainSchedule/Lesson?groupId=@group.Id&lessonNumber=@i&weekday=@weekdayId">
										<h6>@firstLesson.Subject.Name</h6>
									</a>
									<a class="selectedLesson border" href="/MainSchedule/Lesson?groupId=@group.Id&lessonNumber=@i&weekday=@weekdayId">
										<h6>@secondLesson.Subject.Name</h6>
									</a>
								}
							}

						</div>
					}
				</div>
			}
		</div>
		<hr style="width: calc(16.66666667% * @Model.Groups.Count() + 13%)" />
	}
</div>

